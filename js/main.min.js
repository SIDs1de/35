document.addEventListener('DOMContentLoaded', function () {
  let heads = document.querySelectorAll('.questions__head');
  let bodies = document.querySelectorAll('.questions__body');
  let burger = document.querySelector('.header__burger');
  let menu = document.querySelector('.header__menu');
  let body = document.querySelector('.page');
  let menuLinks = document.querySelectorAll('[data-goto]');
  let popupOpenBtns = document.querySelectorAll('[data-open-pop]');
  let popups = document.querySelectorAll('[data-pop]');
  let headerBg = document.querySelector('.header__bg');
  let popupBgs = document.querySelectorAll('.popup__bg');
  let headerLinks = document.querySelectorAll('.header__link');

  const html = document.querySelector('html');
  function wow() {
    wow = new WOW({
      live: false, // default
    });
    wow.init();

    const elements = document.querySelectorAll('.animate__animated');
    elements.forEach(element => {
      element.setAttribute('data-wow-duration', '.8s')
    })

    if (window.innerWidth <= 550) {
      elements.forEach(element => {
        if (parseFloat(element.getAttribute('data-wow-delay')) >= 0.3) {
          element.setAttribute('data-wow-delay', '.3s')
        }
      })
    }
  }

  const linksActivate = () => {
    const btns = document.querySelectorAll('a[href^="#"]');
    const header = document.querySelector('.header');
    const bg = document.querySelector('.burger-bg');
    btns.forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        body.classList.remove('_menu-open')
        html.classList.remove('_menu-open')
        const sectionName = e.target.getAttribute('href');
        let section = null;
        try {
          section = document.querySelector(sectionName);
        } catch {
        }
        if (section) {
          // const elemStyles = getComputedStyle(section)
          // console.log(elemStyles.paddingTop);
          const top = section.getBoundingClientRect()['y'];
          window.scrollTo({
            top: top + window.pageYOffset,
            behavior: 'smooth'
          })
        }
      })
    })
    bg.addEventListener('click', () => {
      body.classList.remove('_menu-open')
      html.classList.remove('_menu-open')
    })
  }

  function accordion() {
    bodies.forEach((body, idx) => {
      idx += 1
      if (!body.getAttribute('data-tab')) {
        body.setAttribute('data-tab', idx)
      }
    })
    heads.forEach((head, idx) => {
      idx += 1
      if (!head.getAttribute('data-tab')) {
        head.setAttribute('data-tab', idx)
      }
    })
    heads.forEach((e) => {
      e.addEventListener('click', () => {
        bodies.forEach((i) => {
          if (i.style.maxHeight) {
            i.style.maxHeight = null;
            i.style.paddingTop = '0px';
            i.previousElementSibling.classList.remove('active');
          } else if (e.dataset.tab === i.dataset.tab) {
            i.previousElementSibling.classList.add('active');
            i.style.maxHeight = i.scrollHeight + 20 + 'px';
            i.style.paddingTop = '20px';
          }
        });
        const top = e.getBoundingClientRect()['y'];
        window.scrollTo({
          top: top + window.pageYOffset,
          behavior: 'smooth'
        })
      });
    });
  }

  const openCloseHeaderBurger = () => {
    const headerBurgerBtn = document.querySelector('.header__burger');
    headerBurgerBtn.addEventListener('click', () => {
      body.classList.toggle('_menu-open')
      html.classList.toggle('_menu-open')
    })
  }

  const swiper = () => {
    const pageSlider = new Swiper('.partners__swiper', {
      // Свои классы
      wrapperClass: 'partners__swiper-wrapper',
      slideClass: 'partners__swiper-slide',

      // Количество слайдов для показа
      slidesPerView: 1,

      // Управление клавиатурой
      keyboard: {
        enabled: true,
        onlyInViewport: true,
        pageUpDown: true,
      },
      watchOverflow: true,
      speed: 800,
      observeParents: true,
      observeSlideChildren: true,
      pagination: {
        el: '.partners__swiper-pagination',
        type: 'bullets',
        clickable: true,
        bulletClass: 'partners__swiper-bullet',
        bulletActiveClass: 'partners__swiper-bullet--active',
      },
      spaceBetween: 30,
      breakpoints: {
        480: {
          spaceBetween: 0,
        },
      }
    });
  }

  const imgsHeight = () => {
    const wrappers = document.querySelectorAll('.documents__column-img-wrapper');
    minHeight = wrappers[1].querySelector('.documents__column-img').offsetHeight
    if (window.innerWidth <= 750) {
      wrappers.forEach((wrapper) => {
        wrapper.style.height = 'auto';
      })
    } else {
      wrappers.forEach((wrapper, i) => {
        if (i !== 1) {
          wrapper.style.height = minHeight + 'px';
        }
      })
    }
  }

  const element = document.querySelector('.footer__item-text-date');
  const footerDate = () => {

    const event = new Date();
    let time = event.toLocaleString('en-GB', { timeZone: 'Europe/London' }).split(', ')[1];

    time = parseInt(time.split(':')[0]) + 1 + ':' + time.split(':')[1] + ':' + time.split(':')[2];

    element.innerHTML = time
  }

  wow();
  accordion();
  linksActivate();
  openCloseHeaderBurger();
  swiper();
  setInterval(footerDate, 1000)
  footerDate();

  let images = ["img/fuehrerschein.jpg"];
  let promises = [];

  images.forEach(function (src) {
    promises.push(new Promise((resolve, reject) => {
      let proxyImage = new Image();

      proxyImage.addEventListener("load", function () {
        resolve();
      });

      proxyImage.src = src;
    }));
  });

  Promise.all(promises).then(function () {
    imgsHeight();
  });
  window.addEventListener('resize', () => {
    imgsHeight();
  })

});
(function () {
  var script = document.createElement('script');
  script.src = 'https://my.zadarma.com/callmewidget/v2.0.8/loader.js';
  document.getElementById('zadarmaScripts').appendChild(script);
}());

var myZadarmaCallmeWidget13587;
var myZadarmaCallmeWidgetFn13587 = function () {
  myZadarmaCallmeWidget13587 = new ZadarmaCallmeWidget("myZadarmaCallmeWidget13587");
  myZadarmaCallmeWidget13587.create({
    "widgetId": "999CY2ceukzM5Y4xtsH886bfnC4BrHzh617zpt5gg4bCkJjyyAh9AVy9Jtm4j36XcmVtgxpKPzas5Sjx6gpTymR4rsA5zExGe7b515f5c1fbcf74afddc4ed3c4fe2c4", "sipId": "135565_11_11", "domElement": "myZadarmaCallmeWidget13587"
  }, {
    "shape": "square", "language": "ru", "width": "0", "dtmf": false, "font": "'Trebuchet MS','Helvetica CY',sans-serif", "color_call": "rgb(255, 255, 255)", "color_bg_call": "rgb(148,219,68)", "color_border_call": "rgb(191, 233, 144)", "color_connection": "rgb(255, 255, 255)", "color_bg_connection": "rgb(33, 211, 166)", "color_border_connection": "rgb(144, 233, 211)", "color_calling": "rgb(255, 255, 255)", "color_border_calling": "rgb(255, 218, 128)", "color_bg_calling": "rgb(255, 181, 0)", "color_ended": "rgb(255, 255, 255)", "color_bg_ended": "rgb(164,164,164)", "color_border_ended": "rgb(210, 210, 210)"
  });
};

if (window.addEventListener) {
  window.addEventListener('load', myZadarmaCallmeWidgetFn13587, false);
} else if (window.attachEvent) {
  window.attachEvent('onload', myZadarmaCallmeWidgetFn13587);
}